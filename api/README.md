# Бизнес-требования: Интернет-магазин автозапчастей

## Функционал Web API

1. **Каталог автозапчастей**

   - Получение списка всех автозапчастей (с поддержкой фильтрации по категории, производителю, совместимости с автомобилями, ценовому диапазону).
   - Поиск автозапчастей по названию, артикулу или ключевым словам.
   - Сортировка (по цене, популярности, новизне, наличию на складе).
   - Пагинация списка.

2. **Информация о конкретной автозапчасти**

   - Получение данных по Id.
   - Характеристики (номер детали, марка и модель автомобиля, производитель, год выпуска, совместимость).
   - Изображения.
   - Список доступных складов/!наличие!.

3. **Категории и подкатегории**

   - Создание древовидной структуры категорий (например: “Тормозная система → Колодки → Передние”).
   - Привязка автозапчастей к категориям.
   - Получение списка автозапчастей внутри категории.

4. **Корзина** // ?

   - Добавление/удаление автозапчастей.
   - Изменение количества.
   - Получение содержимого корзины для текущего пользователя.

5. **Заказы**

   - Создание заказа на основе корзины.
   - Возможность применения промокода или скидки. /// не очень понимаю как написать/реализовать
   - Просмотр списка заказов (пользователь видит свои, администратор — все).
   - Изменение статуса заказа (например: “создан”, “оплачен”, “в обработке”, “отправлен”, “доставлен”).

6. **Отзывы и рейтинг**

   - Добавление отзыва и оценки (только пользователи, купившие товар).
   - Редактирование/удаление своих отзывов.
   - Получение списка отзывов к автозапчасти.

7. **Аутентификация и роли**

   - Регистрация и авторизация пользователей (JWT Access + Refresh Token).
   - Роли:
     - **Пользователь** — просмотр каталога, корзина, заказы, отзывы.
     - **Администратор** — управление товарами, категориями, заказами, промокодами.
   - Получение текущего пользователя по токену.

8. **Профиль пользователя** !!!!!

   - Получение и редактирование данных профиля.
   - Управление адресами доставки.
   - Просмотр истории заказов.

9. **Избранное**

   - Добавление автозапчастей в список избранных.
   - Получение списка избранных товаров.

10. **Система промокодов и скидок**
    - Создание промокодов (только администратор).
    - Применение промокодов при оформлении заказа.

---

## Информация об автозапчасти

1. Название / артикул.
2. Производитель.
3. Категория / подкатегория.
4. Совместимость с марками и моделями автомобилей.
5. Характеристики (год выпуска, материал, размеры).
6. Цена.
7. Наличие на складе.
8. Изображения.
9. Рейтинг и отзывы.

---

## Основные сущности

- **User** (Пользователь)
- **Product** (Автозапчасть)
- **Category** (Категория автозапчастей)
- **Cart** (Корзина)
- **Order** (Заказ)
- **Review** (Отзыв) // можно реализовать попозже
- **Address** (Адрес доставки)
- **PromoCode** (Промокод) // можно реализовать попозже
- **Manufacturer** (Производитель)
- **CarModel** (Марка/модель автомобиля для совместимости) // а есть ли необходимость?

---

## Дополнительный функционал

1. Валидация DTO (например, через `joi`).
2. Swagger-документация к API.
3. Логирование действий (создание заказов, изменения статусов и т.д.).
4. Система уведомлений (например, письмо о подтверждении заказа).

---

## Нефункциональные требования

1. Должен быть настроен **ESLint и Prettier** для поддержания единого стиля кода.
2. Проект должен быть реализован на **TypeScript**.
3. Работа с **Git** должна выполняться по Git Flow с использованием Conventional Commits.
4. Функционал должен быть покрыт тестами не менее чем на **80%** (Unit, Integration, E2E-тесты).
5. Должен быть настроен **CI/CD через Github Actions** (линтинг, тесты, деплой).

---

## Стек

1. Node.js
2. Express
3. PostgreSQL
4. TypeScript
5. PassportJS / JWT
6. Swagger
7. Jest / Supertest (или аналог для тестов)
8. ESLint + Prettier
9. Github Actions (CI/CD)

10. Напишем ORM Модель нашего продакта
11. Напишем контроллер для создание продакта
12. Напишем метод создания продакта в сервисе и его валидацию —
13. Валидация должна включать в себя проверку существует ли данная деталь в БД нашего продакта
14. Деталь при создании своего описания должна отправляться в каталог своего производителя, так что получается что нам параллельно нужно будет писать код и для manufacturer, для того чтобы в такой каталог попасть, должно проверяться есть ли такой производитель, и если да, то она туда автоматически попадает, а чтобы туда попасть —
15. Создаем таблицу производителей в БД, тоесть пишем ОРМ модель нашего manufacturer.
16. Тоже самое делаем и для category
17. Проверка цены, в нашем случае цена это number, нужно сделать так чтобы из-за особенной JS она не имела 000001 числа и была круглой цифрой
18. Определиться с "наличием", это будет просто true false, либо number и какое кол-во продакта есть в магазине ?Нужно ли отдельно создавать таблицу в БД для проверки количества продакта в магазине или как это делается? Будет ли в таком случае проверка наличия продакта являться методом updateProduct, ведь по сути эту информацию нужно тоже обновлять, но она же по сути должна быть и при создании, или это будет отдельный метод statusAvailability и если да, то как его правильно интегрировать в проект чтобы не нарушать логику createProduct и updateProduct?
    ПО СУТИ у нас будет БД со всем продактами где мы и сможем корректировать их наличие ?
19. У нашего продакта ОБЯЗАТЕЛЬНО должно быть изображение!
20. У продакта должно быть ОБЯЗАТЕЛЬНО Название и Артикул и Производитель

21. Далее перейдем к созданию DB репозитория продакта —
    1. Напишем маппер продакта/manufacturer/category
    2. Реализуем доменный интерфейс/репозиторий продакта (сначала создание)
